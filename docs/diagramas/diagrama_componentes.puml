@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

Container(api, "API REST") {
    Component(controller, "Controllers", "Spring Web", "Recebem requests, validam dados e chamam casos de uso")

    Component(exceptionHandler, "GlobalExceptionHandler", "Spring", "Converte exceções em respostas HTTP padronizadas")
}

Container(application, "Application Layer") {
    Component(authUseCase, "AuthUseCaseImpl", "Java", "Realiza login, valida credenciais e gera JWT")

    Component(adminUseCase, "AdminUseCaseImpl", "Java", "Gerencia administradores")

    Component(alunoUseCase, "AlunoUseCaseImpl", "Java", "Gerencia alunos")

    Component(turmaUseCase, "TurmaUseCaseImpl", "Java", "Gerencia turmas")

    Component(professorUseCase, "ProfessorUseCaseImpl", "Java", "Gerencia professores")

    Component(mapper, "Mappers", "Java", "Converte DTO -> Domain -> Entity")
}

Container(domain, "Domain Layer") {
    Component(entities, "Entities (Usuario, Aluno, Admin, Professor, Disciplina, Turma)", "Java", "Regras centrais e estrutura do domínio")

    Component(ports, "Repositories (interfaces)", "Java", "Contratos para persistência")
}

Container(infra, "Infrastructure Layer") {
    Component(jwtService, "JwtService", "JJWT", "Gera e valida tokens JWT")

    Component(jwtFilter, "JwtFilter", "Spring Security", "Intercepta requisições e autentica via JWT")

    Component(repoImpl, "JPA Repository Implementations", "Spring Data JPA", "Implementações concretas dos repositórios")

    Component(jpaEntities, "JPA Entities", "Hibernate",  "Mapeamento ORM para o banco")
}

ContainerDb(db, "Database")

controller -> authUseCase
controller -> alunoUseCase
controller -> professorUseCase
controller -> adminUseCase

authUseCase -> repoImpl
authUseCase -> jwtService

jwtFilter -> jwtService
jwtFilter -> repoImpl

application -> domain
repoImpl -> db

@enduml
